define(["jquery","ekyna-string"],function(i){"use strict";function t(t){t.data("FilePicker",this),this.$element=t,this.$file=t.find("input:file"),this.$text=t.find("input:text"),this.current=this.$text.data("current")||null,this.$file.on("change",i.proxy(this.onFileChange,this)),this.$text.on("click",i.proxy(this.onTextClick,this)),t.find('button[data-role="pick"]').on("click",i.proxy(this.onPickClick,this)),t.find('button[data-role="clear"]').on("click",i.proxy(this.onClearClick,this))}return t.prototype.onFileChange=function(){var t=this.$file.val();return 0<t.length?this.$text.val(t.fileName()):this.$text.val(this.current),this.$element.trigger(i.Event("ekyna.upload.change")),!1},t.prototype.onTextClick=function(t){return t.preventDefault(),this.$file.trigger("click"),!1},t.prototype.onPickClick=function(t){return t.preventDefault(),this.$file.trigger("click"),!1},t.prototype.onClearClick=function(t){return t.preventDefault(),this.clear(),this.$element.trigger(i.Event("ekyna.upload.clear")),!1},t.prototype.clear=function(){this.$file.files&&(this.$file.files=[]),this.$text.val(this.current),this.$file.val(null).trigger("change")},i.fn.filePickerWidget=function(){return this.each(function(){void 0===i(this).data("FilePicker")&&new t(i(this))}),this},{init:function(t){t.filePickerWidget()}}});